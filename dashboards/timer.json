{"dashboard":{"annotations":{"list":[{"$$hashKey":"object:196","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"links":[],"panels":[{"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"gridPos":{"h":9,"w":5,"x":0,"y":0},"id":6,"options":{"content":"\u003ch3\u003eSchaltuhr\u003c/h3\u003e\r\n\u003chr /\u003e\r\n\r\n\u003cselect class=\"nanohome\" id=\"timer_device\" onchange=\"cronman('show')\" name=\"nanolist_timer\"\u003e\r\n\u003c/select\u003e\r\n\r\n\u003ctable align=\"center\" style=\"width:100%\"\u003e\r\n        \u003ctr\u003e\r\n            \u003ctd colspan=\"2\"\u003e\r\n\r\n            \u003c/td\u003e\r\n        \u003c/tr\u003e\r\n        \u003ctr\u003e\r\n            \u003ctd align=\"right\" style=\"width:50%\"\u003e\u003cfont size=\"4\"\u003eEin / Auf\u003c/font\u003e\u003c/td\u003e\r\n            \u003ctd align=\"left\" \u003e\u003cinput class=\"form\" id=\"timer_ein\" pattern=\".{5,5}\" onfocus=\"this.value=''\" value=\"08:00\" onfocus=\"this.value=''\" onfocusout=\"if (this.value === '') { this.value = this.defaultValue; }\" autocomplete=\"off\" /\u003e\u003c/td\u003e\r\n        \u003c/tr\u003e\r\n        \u003ctr\u003e\r\n            \u003ctd align=\"right\"  style=\"width:50%\"\u003e\u003cfont size=\"4\"\u003eAus / Zu\u003c/font\u003e\u003c/td\u003e\r\n            \u003ctd align=\"left\" \u003e\u003cinput class=\"form\" id=\"timer_aus\" pattern=\".{5,5}\" onfocus=\"this.value=''\" value=\"22:00\" onfocus=\"this.value=''\" onfocusout=\"if (this.value === '') { this.value = this.defaultValue; }\" autocomplete=\"off\" /\u003e\u003c/td\u003e\r\n        \u003c/tr\u003e\r\n        \u003ctr\u003e\r\n            \u003ctd colspan=\"2\" align=\"center\"\u003e\r\n                \u003cselect class=\"form\" id=\"timer_day\"\u003e\r\n                    \u003coption value=\"*\"\u003eT√§glich\u003c/option\u003e\r\n                    \u003coption value=\"1\"\u003eMontag\u003c/option\u003e\r\n                    \u003coption value=\"2\"\u003eDienstag\u003c/option\u003e\r\n                    \u003coption value=\"3\"\u003eMittwoch\u003c/option\u003e\r\n                    \u003coption value=\"4\"\u003eDonnerstag\u003c/option\u003e\r\n                    \u003coption value=\"5\"\u003eFreitag\u003c/option\u003e\r\n                    \u003coption value=\"6\"\u003eSamstag\u003c/option\u003e\r\n                    \u003coption value=\"0\"\u003eSonntag\u003c/option\u003e\r\n                    \u003coption value=\"6-7\"\u003eWochenende\u003c/option\u003e\r\n                    \u003coption value=\"1-5\"\u003eWerktags\u003c/option\u003e\r\n                \u003c/select\u003e\r\n            \u003c/td\u003e\r\n        \u003c/tr\u003e\r\n        \u003ctr\u003e\r\n            \u003ctd colspan=\"2\" align=\"center\"\u003e\r\n                \u003cbutton title=\"Aktivieren\" class=\"form\" style=\"background-color: #adfc95\" onclick=\"cronman('add')\"\u003eüíæ\u003c/button\u003e\r\n                \u003cbutton title=\"Alle anzeigen\" class=\"form\" style=\"background-color: #fff4bd\" onclick=\"cronman('show all')\"\u003eüîé\u003c/button\u003e\r\n                \u003cbutton title=\"Deaktivieren\" class=\"form\" style=\"background-color: #ffbdbd\" onclick=\"cronman('remove')\"\u003e‚ùå\u003c/button\u003e\r\n            \u003c/td\u003e\r\n        \u003c/tr\u003e\r\n    \u003c/table\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cscript\u003e\r\n\r\n\tfunction cronman(param) {\r\n\t\r\n        var zsp_dev = document.getElementById(\"timer_device\").value;\r\n        var zsp_tag = document.getElementById(\"timer_day\").value;\r\n        var zsp_ein = document.getElementById(\"timer_ein\").value;\r\n        var zsp_aus = document.getElementById(\"timer_aus\").value;\r\n\r\n        var zsp_message = \"cronman \" + param + \" '\" + zsp_dev + \"' '\" + zsp_tag + \"' '\" + zsp_ein + \"' '\" + zsp_aus + \"'\";\r\n\t\r\n        publish_timer(zsp_message);\r\n\t\t    \r\n\t};\r\n\r\n\u003c/script\u003e\r\n\r\n","mode":"html"},"pluginVersion":"7.3.6","timeFrom":null,"timeShift":null,"title":"","type":"text"},{"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"gridPos":{"h":19,"w":19,"x":5,"y":0},"id":8,"options":{"content":"\u003chead\u003e\u003clink rel=\"stylesheet\" type=\"text/css\" href=\"../public/style.css\" /\u003e\u003c/head\u003e\r\n\r\n\u003ch3\u003eOutput\u003c/h3\u003e\r\n\u003chr /\u003e\r\n\r\n\u003cdiv style=\"position: fixed;\"\u003e\r\n    \u003cdiv style=\"overflow-y: scroll; height: 600px;\"\u003e\r\n    \u003cspan id=\"timer_output\" style=\"white-space: pre; font-family: monospace; display: block; unicode-bidi: embed; font-size: 14px;\"\u003e\u003c/span\u003e\r\n    \u003c/div\u003e\r\n\u003c/div\u003e\r\n\r\n\u003cscript\u003e\r\n    \r\n    var mqtt;\r\n    var reconnectTimeout = 5000;\r\n    var port = 1884;\r\n    var useTLS = false;\r\n    var user = \"\";\r\n    var pwd = \"\";\r\n    var cleansession = true;\r\n    var path = \"\";\r\n    var buttons = $('[type=button]');\r\n    var host = location.hostname;\r\n    \r\n    console.log(host);\r\n    \r\n    buttons.prop('disabled', true);\r\n   \r\n    function MQTTconnect() {\r\n        if (typeof path == \"undefined\") {\r\n            path = '/mqtt';\r\n        }\r\n        mqtt = new Paho.MQTT.Client(\r\n            host,\r\n            port,\r\n            path,\r\n            \"web_grafanaPanel\" + parseInt(Math.random() * 10000, 10)\r\n        );\r\n        var options = {\r\n            timeout: 3,\r\n            useSSL: useTLS,\r\n            cleanSession: cleansession,\r\n            onSuccess: onConnect,\r\n            onFailure: function (message) {\r\n                $('#status_output').html(\"Connection failed: \" + message.errorMessage + \"Retrying\");\r\n                setTimeout(MQTTconnect, reconnectTimeout);\r\n            }\r\n        };\r\n\t\t\r\n        mqtt.onConnectionLost = onConnectionLost;\r\n        mqtt.onMessageArrived = timer_inbound;\r\n\t   \r\n\t\t\r\n        if (user != null) {\r\n            options.userName = user;\r\n            options.password = pwd;\r\n        }\r\n        console.log(\"Host=\" + host + \", port=\" + port + \", path=\" + path + \" TLS = \" + useTLS + \" username=\" + user + \" password=\" + pwd);\r\n        mqtt.connect(options);\r\n    }\r\n    \r\n    function onConnect() {\r\n        $('#status_output').html('Connected to: ' + host + ':' + port + path);\r\n        // Connection succeeded; subscribe to our topic(s)\r\n        buttons.prop('disabled', false);\r\n    }\r\n\r\n    function onConnectionLost(response) {\r\n        setTimeout(MQTTconnect, reconnectTimeout);\r\n        $('#status_output').html(\"connection lost: \" + response.errorMessage + \". Reconnecting\");\r\n        buttons.prop('disabled', true);\r\n    };\r\n \r\n    function timer_inbound(timer_message) {\r\n        var timer_output = timer_message.payloadString;\r\n        $(\"#timer_output\").html(timer_output);\r\n    }\r\n\r\n    var publish_timer = function (timer_payload) {\r\n        mqtt.subscribe(\"output\", {\r\n            qos: 2,\r\n        });\r\n\r\n        console.log(\"Sending: \" + JSON.stringify(timer_payload));\r\n\r\n        var timer_message = new Paho.MQTT.Message(timer_payload);\r\n        timer_message.destinationName = \"input\";\r\n        timer_message.qos = 2;\r\n\r\n        mqtt.send(timer_message);\r\n        \r\n        // mqtt unsubscribe here if something goes havoc\r\n\r\n    };\r\n \r\n    if (typeof Paho === 'undefined') {\r\n        var script = document.createElement('script');\r\n        document.body.appendChild(script);\r\n        script.onload = function () {\r\n            MQTTconnect();\r\n        }\r\n        script.src = '../public/mqttws31.min.js';\r\n    } else {\r\n       MQTTconnect();\r\n    }\r\n\r\n\u003c/script\u003e","mode":"html"},"pluginVersion":"7.3.6","timeFrom":null,"timeShift":null,"title":"","transparent":true,"type":"text"},{"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"gridPos":{"h":7,"w":5,"x":0,"y":9},"id":9,"options":{"content":"\u003ch3\u003eStandbykiller\u003c/h3\u003e\r\n\u003chr /\u003e\r\n\r\n\u003ccenter\u003e\r\n\r\n\u003cselect class=\"nanohome\" id=\"stby_device\"onchange=\"standbykill('show')\" name=\"nanolist_stbykill\"\u003e\r\n\u003c/select\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003ctable align=\"center\" style=\"width:100%\"\u003e\r\n    \u003ctr\u003e\r\n        \u003ctd align=\"right\" style=\"width:50%\"\u003e\u003cfont size=\"4\"\u003eStandby [W]\u003c/font\u003e\u003c/td\u003e\r\n        \u003ctd align=\"left\" style=\"width:50%\"\u003e\u003cinput class=\"form\" style=\"width:50%\" id=\"stbypwr\" maxlength=\"5\" value=\"20\" onfocus=\"this.value=''\" onfocusout=\"if (this.value === '') { this.value = this.defaultValue; }\" autocomplete=\"off\"/\u003e\u003c/td\u003e\r\n    \u003c/tr\u003e\r\n\u003c/table\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003cbutton title=\"Aktivieren\" class=\"form\" style=\"background-color: #adfc95\" onclick=\"standbykill('add')\"\u003eüíæ\u003c/button\u003e\r\n\u003cbutton title=\"Alle Anzeigen\" class=\"form\" style=\"background-color: #fff4bd\" onclick=\"standbykill('show all')\"\u003eüîé\u003c/button\u003e\r\n\u003cbutton title=\"Deaktivieren\" class=\"form\" style=\"background-color: #ffbdbd\" onclick=\"standbykill('remove')\"\u003e‚ùå\u003c/button\u003e\r\n\r\n\u003c/center\u003e\r\n\r\n\u003cscript\u003e\r\n\r\n    function standbykill(param) {\r\n\t\r\n        var stby_dev = document.getElementById(\"stby_device\").value;\r\n        var stby_pwr = document.getElementById(\"stbypwr\").value;\r\n\t\t\r\n        var stdby_kill = \"standbykiller \" + param + \" '\" + stby_dev + \"' '\" + stby_pwr + \"'\";\r\n\r\n        publish_timer(stdby_kill);\r\n        \r\n\t};\r\n\r\n\u003c/script\u003e\r\n\r\n","mode":"html"},"pluginVersion":"7.3.6","timeFrom":null,"timeShift":null,"title":"","type":"text"},{"datasource":null,"fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"gridPos":{"h":9,"w":5,"x":0,"y":16},"id":10,"options":{"content":"\u003ch3\u003eMultiswitch\u003c/h3\u003e\r\n\u003chr /\u003e\r\n\r\n\u003ccenter\u003e\r\n\r\n\u003cselect class=\"nanohome\" id=\"multi_dev1\" onchange=\"multiswitch('show')\" name=\"nanolist_multiswitch\"\u003e\r\n\t\u003coption selected disabled\u003eWenn...\u003c/option\u003e\r\n\u003c/select\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003cselect class=\"nanohome\" id=\"multi_dev2\" onchange=\"multiswitch('show')\" name=\"nanolist\"\u003e\r\n\t\u003coption selected disabled\u003eDann...\u003c/option\u003e\r\n\u003c/select\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003cselect class=\"form\" id=\"multi_day\" onchange=\"show_time()\"\u003e\r\n    \u003coption selected disabled\u003eAktiv...\u003c/option\u003e\r\n    \u003coption value=\"always\"\u003eImmer\u003c/option\u003e\r\n    \u003coption value=\"*\"\u003eT√§glich\u003c/option\u003e\r\n    \u003coption value=\"1\"\u003eMontag\u003c/option\u003e\r\n    \u003coption value=\"2\"\u003eDienstag\u003c/option\u003e\r\n    \u003coption value=\"3\"\u003eMittwoch\u003c/option\u003e\r\n    \u003coption value=\"4\"\u003eDonnerstag\u003c/option\u003e\r\n    \u003coption value=\"5\"\u003eFreitag\u003c/option\u003e\r\n    \u003coption value=\"6\"\u003eSamstag\u003c/option\u003e\r\n    \u003coption value=\"0\"\u003eSonntag\u003c/option\u003e\r\n    \u003coption value=\"6-7\"\u003eWochenende\u003c/option\u003e\r\n    \u003coption value=\"1-5\"\u003eWerktags\u003c/option\u003e\r\n\u003c/select\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003cinput class=\"form\" id=\"multi_on\" pattern=\".{5,5}\" value=\"-\" onfocus=\"this.value=''\" onfocusout=\"if (this.value === '') { this.value = this.defaultValue; }\" autocomplete=\"off\" /\u003e\r\n\u003cfont size=\"4\"\u003e-\u003c/font\u003e\r\n\u003cinput class=\"form\" id=\"multi_off\" pattern=\".{5,5}\" value=\"-\" onfocus=\"this.value=''\" onfocusout=\"if (this.value === '') { this.value = this.defaultValue; }\" autocomplete=\"off\" /\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003cbutton title=\"Aktivieren\" class=\"form\" style=\"background-color: #adfc95\" onclick=\"multiswitch('add')\"\u003eüíæ\u003c/button\u003e\r\n\u003cbutton title=\"Alle Anzeigen\" class=\"form\" style=\"background-color: #fff4bd\" onclick=\"multiswitch('show all')\"\u003eüîé\u003c/button\u003e\r\n\u003cbutton title=\"Deaktivieren\" class=\"form\" style=\"background-color: #ffbdbd\" onclick=\"multiswitch('remove')\"\u003e‚ùå\u003c/button\u003e\r\n\r\n\u003c/p\u003e\r\n\r\n\u003c/center\u003e\r\n\r\n\u003cscript\u003e\r\n\r\n    function multiswitch(param) {\r\n        var multi_dev1 = document.getElementById(\"multi_dev1\").value;\r\n        var multi_dev2 = document.getElementById(\"multi_dev2\").value;\r\n        var multi_day = document.getElementById(\"multi_day\").value;\r\n        var multi_on = document.getElementById(\"multi_on\").value;\r\n        var multi_off = document.getElementById(\"multi_off\").value;\r\n\r\n        var multiswitch_message = \"multiswitch \" + param + \" '\" + multi_dev1 + \"' '\" + multi_dev2 + \"' '\" + multi_day + \"' '\" + multi_on + \"' '\" + multi_off + \"'\";\r\n\r\n        publish_timer(multiswitch_message);\r\n\r\n    }\r\n\r\n    function show_time() {\r\n      \r\n        var multi_day = document.getElementById(\"multi_day\");\r\n\r\n        if (multi_day.value !== \"always\") {\r\n          \r\n            document.getElementById(\"multi_on\").value = \"08:00\";\r\n            document.getElementById(\"multi_off\").value = \"22:00\";\r\n            \r\n        } else {\r\n          \r\n            document.getElementById(\"multi_on\").value = \"-\";\r\n            document.getElementById(\"multi_off\").value = \"-\";\r\n            \r\n        }\r\n    }\r\n\r\n\u003c/script\u003e\r\n","mode":"html"},"pluginVersion":"7.3.6","timeFrom":null,"timeShift":null,"title":"","type":"text"}],"refresh":false,"schemaVersion":26,"style":"dark","tags":[],"templating":{"list":[]},"time":{"from":"now-6h","to":"now"},"timepicker":{"hidden":true,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"Schaltuhr","uid":"_H3fwdmRz","version":1}}